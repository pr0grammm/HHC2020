
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.4">
    
    
      
        <title>2) Investigate S3 Bucket - KringleCon HHC2020 ðŸŽ…</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.75751829.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-orange" data-md-color-accent="">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#2-investigate-s3-bucket" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="KringleCon HHC2020 ðŸŽ…" class="md-header-nav__button md-logo" aria-label="KringleCon HHC2020 ðŸŽ…">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            KringleCon HHC2020 ðŸŽ…
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              2) Investigate S3 Bucket
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="KringleCon HHC2020 ðŸŽ…" class="md-nav__button md-logo" aria-label="KringleCon HHC2020 ðŸŽ…">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    KringleCon HHC2020 ðŸŽ…
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      



  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Objectives
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Objectives" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Objectives
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../objective1/" class="md-nav__link">
      1) Uncover Santa's Gift List
    </a>
  </li>

        
          
          
          


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        2) Investigate S3 Bucket
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      2) Investigate S3 Bucket
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-objective" class="md-nav__link">
    The Objective
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chat-with-shinny-upatree" class="md-nav__link">
    Chat with Shinny Upatree
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hints-courtesy-shinny-upatree" class="md-nav__link">
    Hints Courtesy Shinny Upatree
  </a>
  
    <nav class="md-nav" aria-label="Hints Courtesy Shinny Upatree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#find-santas-package" class="md-nav__link">
    Find Santa's Package
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leaky-aws-s3-buckets" class="md-nav__link">
    Leaky AWS S3 Buckets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-s3-buckets" class="md-nav__link">
    Finding S3 Buckets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bucket_finderrb" class="md-nav__link">
    Bucket_finder.rb
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#santas-wrapper3000" class="md-nav__link">
    Santa's Wrapper3000
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    Solution
  </a>
  
    <nav class="md-nav" aria-label="Solution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#finding-the-s3-bucket" class="md-nav__link">
    Finding the S3 bucket
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unwrapping-the-package-file" class="md-nav__link">
    Unwrapping the Package File
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rejoice" class="md-nav__link">
    Rejoice
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../objective3/" class="md-nav__link">
      3) Point-of-Sale Password Recovery
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../objective4/" class="md-nav__link">
      4) Operate the Santavator
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../objective5/" class="md-nav__link">
      5) Open HID Lock
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../objective6/" class="md-nav__link">
      6) Splunk Challenge
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../objective7/" class="md-nav__link">
      7) Solve the Sleigh's CAN-D-BUS Problem
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../objective8/" class="md-nav__link">
      8) Broken Tag Generator
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../objective9/" class="md-nav__link">
      9) ARP Shenanigans
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../objective10/" class="md-nav__link">
      10) Defeat Fingerprint Sensor
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../objective11a/" class="md-nav__link">
      11a) Naughty/Nice List with Blockchain Investigation Part 1
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../objective11b/" class="md-nav__link">
      11b) Naughty/Nice List with Blockchain Investigation Part 2
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" data-md-state="indeterminate" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Terminals
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Terminals" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Terminals
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../terminals/terminal1/" class="md-nav__link">
      Kringle Kiosk
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../terminals/terminal2/" class="md-nav__link">
      Linux Primer
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../terminals/terminal3/" class="md-nav__link">
      Unescape Tmux
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../terminals/terminal4/" class="md-nav__link">
      Speaker Door Open
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../terminals/terminal5/" class="md-nav__link">
      Speaker Lights On
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../terminals/terminal6/" class="md-nav__link">
      Speaker Vending Machine On
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../terminals/terminal7/" class="md-nav__link">
      Regex Toy Sorting
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../terminals/terminal8/" class="md-nav__link">
      CAN-Bus Investigation
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../terminals/terminal12/" class="md-nav__link">
      Snowball Game
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-objective" class="md-nav__link">
    The Objective
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chat-with-shinny-upatree" class="md-nav__link">
    Chat with Shinny Upatree
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hints-courtesy-shinny-upatree" class="md-nav__link">
    Hints Courtesy Shinny Upatree
  </a>
  
    <nav class="md-nav" aria-label="Hints Courtesy Shinny Upatree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#find-santas-package" class="md-nav__link">
    Find Santa's Package
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leaky-aws-s3-buckets" class="md-nav__link">
    Leaky AWS S3 Buckets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-s3-buckets" class="md-nav__link">
    Finding S3 Buckets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bucket_finderrb" class="md-nav__link">
    Bucket_finder.rb
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#santas-wrapper3000" class="md-nav__link">
    Santa's Wrapper3000
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    Solution
  </a>
  
    <nav class="md-nav" aria-label="Solution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#finding-the-s3-bucket" class="md-nav__link">
    Finding the S3 bucket
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unwrapping-the-package-file" class="md-nav__link">
    Unwrapping the Package File
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rejoice" class="md-nav__link">
    Rejoice
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="2-investigate-s3-bucket">2) Investigate S3 Bucket</h1>
<blockquote>
<p>difficulty ðŸŽ„</p>
</blockquote>
<h2 id="the-objective">The Objective</h2>
<blockquote>
<p>When you unwrap the over-wrapped file, what text string is inside the package? Talk to Shinny Upatree in front of the castle for hints on this challenge.</p>
</blockquote>
<h2 id="chat-with-shinny-upatree">Chat with Shinny Upatree</h2>
<p>After we help Shinny with the Kringle Kiosk Terminal Challenge the following conversation ensues.</p>
<blockquote>
<p>Golly - wow! You sure found the flaw for us!</p>
<p>Say, we've been having an issue with an Amazon S3 bucket.</p>
<p>Do you think you could help find Santa's package file?</p>
<p>Jeepers, it seems there's always a leaky bucket in the news. You'd think we could find our own files!</p>
<p>Digininja has a great guide, if you're new to S3 searching.</p>
<p>He even released a tool for the task - what a guy!</p>
<p>The package wrapper Santa used is reversible, but it may take you some trying.</p>
<p>Good luck, and thanks for pitching in!</p>
</blockquote>
<h2 id="hints-courtesy-shinny-upatree">Hints Courtesy Shinny Upatree</h2>
<h3 id="find-santas-package">Find Santa's Package</h3>
<blockquote>
<p>Find Santa's package file from the cloud storage provider. Check Josh Wright's <a href="https://www.youtube.com/watch?v=t4UzXx5JHk0">talk</a> for more tips!</p>
</blockquote>
<h3 id="leaky-aws-s3-buckets">Leaky AWS S3 Buckets</h3>
<blockquote>
<p>It seems like there's a new story every week about data exposed through unprotected <a href="https://www.computerweekly.com/news/252491842/Leaky-AWS-S3-bucket-once-again-at-centre-of-data-breach">Amazon S3 buckets</a>.</p>
</blockquote>
<h3 id="finding-s3-buckets">Finding S3 Buckets</h3>
<blockquote>
<p>Robin Wood wrote up a guide about <a href="https://digi.ninja/blog/whats_in_amazons_buckets.php">finding these open S3 buckets</a>.</p>
</blockquote>
<h3 id="bucket_finderrb">Bucket_finder.rb</h3>
<blockquote>
<p>He even wrote a tool to <a href="https://digi.ninja/projects/bucket_finder.php">search for unprotected buckets</a>!</p>
</blockquote>
<h3 id="santas-wrapper3000">Santa's Wrapper3000</h3>
<blockquote>
<p>Santa's Wrapper3000 is pretty buggy. It uses several compression tools, binary to ASCII conversion, and other tools to wrap packages.</p>
</blockquote>
<h2 id="solution">Solution</h2>
<p>In this challenge we need to find Santa's package file. We understand that this file is stored in an Amazon S3 bucket. To access Santa's package we would need to know the S3 bucket name and what's more we would need to have permissions to access the bucket contents.</p>
<p>Hey but data exposed through unprotected S3 buckets is not uncommon so we could get lucky and get around permissions.</p>
<h3 id="finding-the-s3-bucket">Finding the S3 bucket</h3>
<p>On terminal start-up we are greeted with the following MOTD.The word "Wrapper3000" has been highlighted in green so this must be relevant. Could this maybe be the name of the bucket? </p>
<p>The hints highlighted in red seem to deal with unwrapping the package file once we find it.</p>
<p><img alt="alt text" src="../../images/obj2/motd.PNG" /></p>
<p>On listing directory contents we find the program bucket_finder.rb and this is the tool we will use to find unprotected s3 buckets.</p>
<blockquote>
<p>usage: <code>./bucket_finder.rb wordlist</code></p>
</blockquote>
<p>All we need to do is specify a wordlist and the tool checks each word to see if that bucket name exists in the Amazon's S3 system. Any that it finds it will check to see if the bucket is public, private or a redirect.</p>
<p>Let's first run the tool with the default wordlist given to us</p>
<pre><code class="language-bash">elf@f749b6bdc8c1:~/bucket_finder$ ls -l
total 20
-rw-r--r-- 1 elf elf 2550 Dec  5 00:00 README
-rwxr-xr-x 1 elf elf 9121 Dec 17 13:08 bucket_finder.rb
-rw-r--r-- 1 elf elf   28 Dec  5 00:00 wordlist
elf@f749b6bdc8c1:~/bucket_finder$ cat wordlist 
kringlecastle
wrapper
santa
elf@f749b6bdc8c1:~/bucket_finder$ ./bucket_finder.rb wordlist 
http://s3.amazonaws.com/kringlecastle
Bucket found but access denied: kringlecastle
http://s3.amazonaws.com/wrapper
Bucket found but access denied: wrapper
http://s3.amazonaws.com/santa
Bucket santa redirects to: santa.s3.amazonaws.com
http://santa.s3.amazonaws.com/
        Bucket found but access denied: santa
</code></pre>
<p>The output tells us that while all these buckets exist, we don't have access to any of them ðŸ˜ž</p>
<p>Let's add our guess "wrapper3000" to the wordlist and try the program again. (Note the lower case "w", Amazon S3 bucket names have certain restrictions and must adhere to certain rules one of which states that </p>
<blockquote>
<p>Bucket names can consist only of lowercase letters, numbers, dots (.), and hyphens (-).)</p>
</blockquote>
<pre><code class="language-bash">elf@f749b6bdc8c1:~/bucket_finder$ echo &quot;wrapper3000&quot; &gt;&gt; wordlist
elf@f749b6bdc8c1:~/bucket_finder$ cat wordlist 
kringlecastle
wrapper
santa
wrapper3000
elf@f749b6bdc8c1:~/bucket_finder$ ./bucket_finder.rb wordlist 
http://s3.amazonaws.com/kringlecastle
Bucket found but access denied: kringlecastle
http://s3.amazonaws.com/wrapper
Bucket found but access denied: wrapper
http://s3.amazonaws.com/santa
Bucket santa redirects to: santa.s3.amazonaws.com
http://santa.s3.amazonaws.com/
        Bucket found but access denied: santa
http://s3.amazonaws.com/wrapper3000
Bucket Found: wrapper3000 ( http://s3.amazonaws.com/wrapper3000 )
        &lt;Public&gt; http://s3.amazonaws.com/wrapper3000/package
</code></pre>
<p>And Voila we have access to this bucket and the program conveniently spits out the URL to the public package file inside the bucket. Let's download the file.</p>
<pre><code class="language-bash">elf@f749b6bdc8c1:~/bucket_finder$ curl http://s3.amazonaws.com/wrapper3000/package &gt; package
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   829  100   829    0     0   9987      0 --:--:-- --:--:-- --:--:--  9987
elf@f749b6bdc8c1:~/bucket_finder$ ls
README  bucket_finder.rb  package  wordlist

</code></pre>
<h2 id="unwrapping-the-package-file">Unwrapping the Package File</h2>
<p>Take another look at the MOTD for some hints on unwrapping. Three commands are suggested</p>
<blockquote>
<p><code>file</code> to identify a file type</p>
<p><code>man</code> to get more information on a command</p>
<p><code>apropos</code> to search man pages</p>
</blockquote>
<p>Let's inspect this file by using the file command and cat command</p>
<pre><code class="language-bash">elf@f749b6bdc8c1:~/bucket_finder$ file package
package: ASCII text, with very long lines
elf@ee259b7eb5a8:~/bucket_finder$ cat package
UEsDBAoAAAAAAIAwhFEbRT8anwEAAJ8BAAAcABwAcGFja2FnZS50eHQuWi54ei54eGQudGFyLmJ6MlVUCQADoBfKX6AXyl91eAsAAQT2AQAABBQAAABCWmg5MUFZJlNZ2ktivwABHv+Q3hASgGSn//AvBxDwf/xe0gQAAAgwAVmkYRTKe1PVM9U0ekMg2poAAAGgPUPUGqehhCMSgaBoAD1NNAAAAyEmJpR5QGg0bSPU/VA0eo9IaHqBkxw2YZK2NUASOegDIzwMXMHBCFACgIEvQ2Jrg8V50tDjh61Pt3Q8CmgpFFunc1Ipui+SqsYB04M/gWKKc0Vs2DXkzeJmiktINqjo3JjKAA4dLgLtPN15oADLe80tnfLGXhIWaJMiEeSX992uxodRJ6EAzIFzqSbWtnNqCTEDML9AK7HHSzyyBYKwCFBVJh17T636a6YgyjX0eE0IsCbjcBkRPgkKz6q0okb1sWicMaky2Mgsqw2nUm5ayPHUeIktnBIvkiUWxYEiRs5nFOM8MTk8SitV7lcxOKst2QedSxZ851ceDQexsLsJ3C89Z/gQ6Xn6KBKqFsKyTkaqO+1FgmImtHKoJkMctd2B9JkcwvMr+hWIEcIQjAZGhSKYNPxHJFqJ3t32Vjgn/OGdQJiIHv4u5IpwoSG0lsV+UEsBAh4DCgAAAAAAgDCEURtFPxqfAQAAnwEAABwAGAAAAAAAAAAAAKSBAAAAAHBhY2thZ2UudHh0LloueHoueHhkLnRhci5iejJVVAUAA6AXyl91eAsAAQT2AQAABBQAAABQSwUGAAAAAAEAAQBiAAAA9QEAAAAA
</code></pre>
<p>This looks like some encoded data. Let's use CyberChef tool with the Magic recipe to decode this.</p>
<ol>
<li>Cyberchef detects the data as base64 encoded and decodes it.</li>
<li>It detects that the decoded data is a zip archive and proceeds to extract the following file from the archive.</li>
</ol>
<blockquote>
<p><code>package.txt.Z.xz.xxd.tar.bz2</code></p>
</blockquote>
<ol>
<li>
<p>It further detects that the extracted file is bz2 compressed data and proceeds to uncompress it.</p>
</li>
<li>
<p>It detects the uncompressed data as a tar</p>
</li>
</ol>
<p><img alt="cyberchef output depth 3" src="../../images/obj2/cyberchef_depth3.PNG" /></p>
<p>By default the depth is 3 but by increasing the depth, CyberChef is able to unravel many more layers of the file.</p>
<p><img alt="cyberchef output depth 6" src="../../images/obj2/cyberchef_depth6.PNG" /></p>
<p>However CyberChef doesn't seem able to decode beyond a certain point (It isn't able to proceed past <code>package.txt.Z.xz</code>). Let's try this process on linux terminal. We would use <code>file</code> command to detect the file type and find out the matching operation for this file type (either by a google search or using the <code>apropos</code> or <code>man</code> command).
Below is a visualisation of the "wrapping" and "unwrapping" process along with matching commands.</p>
<p><img alt="wrap unwrap" src="../../images/obj2/wrapunwrap.png" /></p>
<p>Finally we can apply the operation to "unwrap" one layer of the file. The code below shows the entire process.</p>
<pre><code class="language-bash">elf@bf22ef953c26:~/bucket_finder$ file package      
package: ASCII text, with very long lines
elf@bf22ef953c26:~/bucket_finder$ base64 -d package &gt; package.zip
elf@bf22ef953c26:~/bucket_finder$ file package.zip  
package.zip: Zip archive data, at least v1.0 to extract
elf@bf22ef953c26:~/bucket_finder$ unzip package.zip 
Archive:  package.zip
 extracting: package.txt.Z.xz.xxd.tar.bz2  
elf@bf22ef953c26:~/bucket_finder$ file package.txt.Z.xz.xxd.tar.bz2
package.txt.Z.xz.xxd.tar.bz2: bzip2 compressed data, block size = 900k
elf@bf22ef953c26:~/bucket_finder$ bunzip2 package.txt.Z.xz.xxd.tar.bz2
elf@bf22ef953c26:~/bucket_finder$ file package.txt.Z.xz.xxd.tar
package.txt.Z.xz.xxd.tar: POSIX tar archive
elf@bf22ef953c26:~/bucket_finder$ tar -xvf package.txt.Z.xz.xxd.tar
package.txt.Z.xz.xxd
elf@bf22ef953c26:~/bucket_finder$ file package.txt.Z.xz.xxd
package.txt.Z.xz.xxd: ASCII text
elf@bf22ef953c26:~/bucket_finder$ xxd -r package.txt.Z.xz.xxd &gt; pack.xz        
elf@bf22ef953c26:~/bucket_finder$ file pack.xz
pack.xz: XZ compressed data
elf@bf22ef953c26:~/bucket_finder$ unxz pack.xz
elf@bf22ef953c26:~/bucket_finder$ file pack
pack: compress'd data 16 bits
elf@bf22ef953c26:~/bucket_finder$ uncompress pack
gzip: pack: unknown suffix -- ignored
elf@bf22ef953c26:~/bucket_finder$ mv pack pack.gz
elf@bf22ef953c26:~/bucket_finder$ uncompress pack.gz   
elf@bf22ef953c26:~/bucket_finder$ file pack
pack: ASCII text
elf@bf22ef953c26:~/bucket_finder$ cat pack
North Pole: The Frostiest Place on Earth
</code></pre>
<h2 id="rejoice">Rejoice</h2>
<p>We successfully unwrapped Santa's super over-wrapped package!</p>
<blockquote>
<p>Answer</p>
<p>North Pole: The Frostiest Place on Earth</p>
</blockquote>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../objective1/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                1) Uncover Santa's Gift List
              </div>
            </div>
          </a>
        
        
          <a href="../objective3/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                3) Point-of-Sale Password Recovery
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="../../assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ['navigation.expand'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>